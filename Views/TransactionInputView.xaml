<UserControl x:Class="NexusFinance.Views.TransactionInputView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:loc="clr-namespace:NexusFinance.Services"
             Background="#050505">
    
    <UserControl.Resources>
        <!-- GLASS PANEL STYLE -->
        <Style x:Key="GlassPanelStyle" TargetType="Border">
            <Setter Property="Background" Value="#CC181818"/>
            <Setter Property="BorderBrush" Value="#33FFFFFF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" ShadowDepth="0" BlurRadius="15" Opacity="0.4"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- SECTION LABEL STYLE -->
        <Style x:Key="SectionLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Foreground" Value="#707070"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        
        <!-- INPUT BOX STYLE -->
        <Style x:Key="StealthInputStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#0CFFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#404040"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="CaretBrush" Value="#E0E0E0"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <Border Style="{StaticResource GlassPanelStyle}" 
               MaxWidth="700" 
               MaxHeight="700"
               VerticalAlignment="Center"
               HorizontalAlignment="Center"
               Padding="30">
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>    <!-- Scrollable Content -->
                    <RowDefinition Height="Auto"/> <!-- Footer Actions -->
                </Grid.RowDefinitions>
                
                <!-- SCROLLABLE CONTENT -->
                <ScrollViewer Grid.Row="0"
                            VerticalScrollBarVisibility="Auto"
                            HorizontalScrollBarVisibility="Disabled"
                            Style="{StaticResource StealthScrollViewerStyle}"
                            Margin="0,0,-10,0">
                    <StackPanel Margin="0,0,10,20">
                        
                        <!-- HEADER -->
                        <TextBlock FontSize="22" 
                                  FontWeight="Bold" 
                                  Foreground="#E0E0E0" 
                                  Margin="0,0,0,20">
                            <Run Text="âš¡ "/>
                            <Run Text="{loc:Translate Key=Transaction_Title}"/>
                        </TextBlock>
                        
                        <!-- SMART COMMAND BAR -->
                        <Border Background="#20FFFFFF" 
                               CornerRadius="8" 
                               Padding="15"
                               Margin="0,0,0,25"
                               BorderBrush="#404040"
                               BorderThickness="1">
                            <Grid>
                                <TextBox x:Name="SmartInputBox"
                                        Background="Transparent"
                                        Foreground="#C0C0C0"
                                        BorderThickness="0"
                                        FontSize="13"
                                        FontFamily="Consolas"
                                        Text="Magic Input: '12500 AWS Server #NexusAI' (Future feature)"
                                        IsEnabled="False"/>
                                <TextBlock Text="ðŸª„" 
                                          FontSize="16" 
                                          HorizontalAlignment="Right" 
                                          VerticalAlignment="Center"
                                          Margin="0,0,5,0"
                                          Opacity="0.3"/>
                            </Grid>
                        </Border>
                        
                        <!-- MAIN FORM GRID -->
                        <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/> <!-- Left: Hard Data -->
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="3*"/> <!-- Right: Context -->
                    </Grid.ColumnDefinitions>
                    
                    <!-- LEFT COLUMN: HARD DATA -->
                    <StackPanel Grid.Column="0">
                        
                        <!-- TRANSACTION TYPE - SEGMENTED CONTROL -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Type}" Style="{StaticResource SectionLabelStyle}"/>
                        <Border Background="#0A000000" 
                               CornerRadius="8" 
                               Padding="4"
                               Margin="0,0,0,20"
                               BorderBrush="#404040"
                               BorderThickness="1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <RadioButton Grid.Column="0"
                                            x:Name="IncomeRadio"
                                            Content="{loc:Translate Key=Transaction_Income}"
                                            GroupName="TransactionType"
                                            Foreground="#808080"
                                            FontSize="12"
                                            FontWeight="SemiBold"
                                            Padding="12,8"
                                            HorizontalContentAlignment="Center"
                                            IsChecked="{Binding IsIncome}">
                                    <RadioButton.Style>
                                        <Style TargetType="RadioButton">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="RadioButton">
                                                        <Border Background="Transparent" 
                                                               CornerRadius="6"
                                                               Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            <Border.Style>
                                                                <Style TargetType="Border">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}}" Value="True">
                                                                            <Setter Property="Background" Value="#C0C0C0"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Border.Style>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsChecked" Value="True">
                                                    <Setter Property="Foreground" Value="Black"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </RadioButton.Style>
                                </RadioButton>
                                
                                <RadioButton Grid.Column="1"
                                            x:Name="ExpenseRadio"
                                            Content="{loc:Translate Key=Transaction_Expense}"
                                            GroupName="TransactionType"
                                            Foreground="#808080"
                                            FontSize="12"
                                            FontWeight="SemiBold"
                                            Padding="12,8"
                                            HorizontalContentAlignment="Center">
                                    <RadioButton.Style>
                                        <Style TargetType="RadioButton">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="RadioButton">
                                                        <Border Background="Transparent" 
                                                               CornerRadius="6"
                                                               Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            <Border.Style>
                                                                <Style TargetType="Border">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}}" Value="True">
                                                                            <Setter Property="Background" Value="#C0C0C0"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Border.Style>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsChecked" Value="True">
                                                    <Setter Property="Foreground" Value="Black"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </RadioButton.Style>
                                </RadioButton>
                            </Grid>
                        </Border>
                        
                        <!-- AMOUNT (BIG) -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Amount}" Style="{StaticResource SectionLabelStyle}"/>
                        <Border Background="#0CFFFFFF" 
                               CornerRadius="8" 
                               Padding="15,12"
                               Margin="0,0,0,20"
                               BorderBrush="#505050"
                               BorderThickness="1">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="â‚½" 
                                          FontSize="24" 
                                          Foreground="#808080"
                                          VerticalAlignment="Center"
                                          Margin="5,0,8,0"/>
                                <TextBox x:Name="AmountBox"
                                        Text="{Binding Amount, UpdateSourceTrigger=PropertyChanged}"
                                        Background="Transparent"
                                        Foreground="#E0E0E0"
                                        BorderThickness="0"
                                        FontSize="24"
                                        FontWeight="Bold"
                                        VerticalContentAlignment="Center"
                                        CaretBrush="White"
                                        MinWidth="150"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- DATE -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Date}" Style="{StaticResource SectionLabelStyle}"/>
                        <DatePicker x:Name="DateBox"
                                   SelectedDate="{Binding SelectedDate}"
                                   Background="#0CFFFFFF"
                                   Foreground="White"
                                   BorderBrush="#404040"
                                   BorderThickness="1"
                                   Padding="12,10"
                                   FontSize="13"
                                   Margin="0,0,0,20"/>
                        
                        <!-- FLAGS -->
                        <StackPanel Margin="0,10,0,0">
                            <CheckBox Content="ðŸ”„ Recurring Transaction"
                                     Foreground="#808080"
                                     FontSize="11"
                                     Margin="0,0,0,8"
                                     IsEnabled="False"
                                     Opacity="0.5"/>
                            <CheckBox Content="âœ… Cleared (Posted)"
                                     Foreground="#808080"
                                     FontSize="11"
                                     IsEnabled="False"
                                     Opacity="0.5"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- RIGHT COLUMN: CONTEXT -->
                    <StackPanel Grid.Column="2">
                        
                        <!-- PROJECT -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Project}" Style="{StaticResource SectionLabelStyle}"/>
                        <ComboBox x:Name="ProjectBox"
                                 ItemsSource="{Binding Projects}"
                                 SelectedItem="{Binding SelectedProject}"
                                 IsEditable="True"
                                 Background="#0CFFFFFF"
                                 Foreground="White"
                                 BorderBrush="#404040"
                                 BorderThickness="1"
                                 Padding="12,10"
                                 FontSize="13"
                                 Margin="0,0,0,20"/>
                        
                        <!-- CATEGORY -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Category}" Style="{StaticResource SectionLabelStyle}"/>
                        <ComboBox x:Name="CategoryBox"
                                 ItemsSource="{Binding Categories}"
                                 SelectedItem="{Binding SelectedCategory}"
                                 IsEditable="True"
                                 Background="#0CFFFFFF"
                                 Foreground="White"
                                 BorderBrush="#404040"
                                 BorderThickness="1"
                                 Padding="12,10"
                                 FontSize="13"
                                 Margin="0,0,0,20"/>
                        
                        <!-- DESCRIPTION -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Description}" Style="{StaticResource SectionLabelStyle}"/>
                        <TextBox x:Name="DescriptionBox"
                                Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}"
                                Background="#0CFFFFFF"
                                Foreground="White"
                                BorderBrush="#404040"
                                BorderThickness="1"
                                Padding="12,10"
                                FontSize="13"
                                Height="80"
                                TextWrapping="Wrap"
                                AcceptsReturn="True"
                                VerticalScrollBarVisibility="Auto"
                                Margin="0,0,0,20"
                                CaretBrush="White"/>
                        
                        <!-- TAGS (Future Feature) -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Tags}" Style="{StaticResource SectionLabelStyle}"/>
                        <TextBox x:Name="TagsBox"
                                Background="#0CFFFFFF"
                                Foreground="#808080"
                                BorderBrush="#404040"
                                BorderThickness="1"
                                Padding="12,10"
                                FontSize="12"
                                Text="#tag1, #tag2"
                                IsEnabled="False"
                                Opacity="0.5"
                                CaretBrush="White"/>
                    </StackPanel>
                        </Grid>
                        
                    </StackPanel>
                </ScrollViewer>
                
                <!-- FOOTER ACTIONS -->
                <Grid Grid.Row="1" Margin="0,15,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- CANCEL (Text Only) -->
                    <Button Grid.Column="0"
                           Content="{loc:Translate Key=Btn_Cancel}" 
                           Command="{Binding CancelCommand}"
                           Background="Transparent"
                           Foreground="#808080"
                           BorderThickness="0"
                           FontSize="12"
                           Padding="15,10"
                           Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                   Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Foreground" Value="#C0C0C0"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    
                    <!-- SAVE & NEW (Outline) -->
                    <Button Grid.Column="2"
                           Content="{loc:Translate Key=Btn_SaveNew}" 
                           Background="Transparent"
                           Foreground="#C0C0C0"
                           BorderBrush="#808080"
                           BorderThickness="1"
                           Padding="20,10"
                           FontSize="12"
                           FontWeight="SemiBold"
                           Cursor="Hand"
                           IsEnabled="False"
                           Opacity="0.5">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" 
                                       BorderBrush="{TemplateBinding BorderBrush}"
                                       BorderThickness="{TemplateBinding BorderThickness}"
                                       CornerRadius="6" 
                                       Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    
                    <!-- EXECUTE (Primary Action - Dark Gradient) -->
                    <Button Grid.Column="4"
                           Command="{Binding AddTransactionCommand}"
                           Style="{StaticResource DarkGradientButton}"
                           Padding="35,12">
                        <TextBlock>
                            <Run Text="âš¡ "/>
                            <Run Text="{loc:Translate Key=Btn_Execute}"/>
                        </TextBlock>
                    </Button>
                </Grid>
                
            </Grid>
        </Border>
    </Grid>
</UserControl>
